/* ===== Reset & Base ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: "Segoe UI", "Hiragino Sans", "Meiryo", sans-serif;
    background: #FFF0E0;
    color: #4A3728;
    min-height: 100vh;
}

#app {
    max-width: 960px;
    margin: 0 auto;
    padding: 16px;
}

/* ===== Header ===== */
header {
    text-align: center;
    margin-bottom: 18px;
}
header h1 {
    font-size: 2rem;
    color: #8B4513;
    letter-spacing: 0.05em;
}
#game-info {
    display: flex;
    justify-content: center;
    gap: 24px;
    margin-top: 6px;
    font-size: 1.05rem;
    font-weight: 600;
    color: #6B4226;
}
.hearts { color: #DC143C; letter-spacing: 3px; font-size: 1.2rem; }

/* ===== Game Area (order + conveyor side-by-side) ===== */
#game-area {
    display: flex;
    gap: 24px;
    align-items: flex-start;
}

/* ===== Order Panel (visual only) ===== */
#order-panel {
    width: 150px;
    flex-shrink: 0;
    background: #fff;
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    text-align: center;
}
.panel-label {
    font-size: 0.9rem;
    font-weight: 700;
    color: #8B4513;
    margin-bottom: 10px;
}
#order-cake {
    min-height: 140px;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding: 8px 4px 0;
    background: #FFF8F0;
    border-radius: 10px;
    border: 2px dashed #E8D5C4;
}

/* ===== Conveyor Section ===== */
#conveyor-section {
    flex: 1;
    background: #fff;
    border-radius: 14px;
    padding: 20px 24px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}

/* -- Step Progress -- */
#step-progress {
    margin-bottom: 16px;
}
.progress-track {
    display: flex;
    align-items: flex-start;
    justify-content: center;
}
.step-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}
.step-connector {
    width: 48px;
    height: 3px;
    background: #DDD;
    margin-top: 8px;
    border-radius: 2px;
    transition: background 0.3s;
}
.step-connector.active { background: #4CAF50; }

.step-dot {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: #E0E0E0;
    border: 2px solid #BBB;
    transition: all 0.3s;
}
.step-dot.completed {
    background: #4CAF50;
    border-color: #388E3C;
}
.step-dot.current {
    background: #FFB74D;
    border-color: #F57C00;
    animation: pulse 1.4s ease-in-out infinite;
}
.step-dot.has-pending {
    background: #FF7043;
    border-color: #E64A19;
    animation: none;
}
@keyframes pulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(255,183,77,0.5); }
    50%      { box-shadow: 0 0 0 6px rgba(255,183,77,0); }
}
.step-label {
    font-size: 0.72rem;
    color: #999;
    white-space: nowrap;
}
.step-item .step-dot.completed + .step-label,
.step-item .step-dot.current + .step-label {
    color: #6B4226;
    font-weight: 600;
}

/* -- Belt Area -- */
#belt-area {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 8px 0 16px;
}

#belt-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
}

#assembly-cake {
    min-height: 170px;
    width: 100%;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding: 10px 0 0;
}

.conveyor-belt {
    width: 100%;
    height: 16px;
    background: repeating-linear-gradient(
        -45deg,
        #888 0, #888 6px,
        #666 6px, #666 12px
    );
    background-size: 17px 17px;
    animation: belt-scroll 0.5s linear infinite;
    border-top: 2px solid #aaa;
    border-bottom: 3px solid #444;
    border-radius: 3px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.25);
}
@keyframes belt-scroll {
    from { background-position-x: 0; }
    to   { background-position-x: 17px; }
}

/* -- Navigation Buttons -- */
.nav-btn {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    border: 3px solid #8B4513;
    background: #FFF;
    font-size: 1.4rem;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #8B4513;
    transition: all 0.2s;
    flex-shrink: 0;
}
.nav-btn:hover:not(:disabled) {
    background: #8B4513;
    color: #FFF;
    transform: scale(1.08);
}
.nav-btn:active:not(:disabled) {
    transform: scale(0.95);
}
.nav-btn:disabled {
    opacity: 0.25;
    cursor: not-allowed;
}
.nav-btn.submit-mode {
    width: auto;
    min-width: 56px;
    padding: 0 18px;
    border-radius: 28px;
    background: #4CAF50;
    border-color: #388E3C;
    color: #fff;
    font-size: 1rem;
}
.nav-btn.submit-mode:hover:not(:disabled) {
    background: #388E3C;
}

/* -- Ingredient Buttons -- */
#ingredients-buttons {
    display: flex;
    justify-content: center;
    gap: 14px;
    flex-wrap: wrap;
    margin-top: 8px;
}

.ingredient-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 12px 20px;
    border: 3px solid #ddd;
    border-radius: 12px;
    background: #fff;
    cursor: pointer;
    font-size: 0.95rem;
    font-weight: 600;
    color: #4A3728;
    transition: transform 0.15s, box-shadow 0.15s, border-color 0.15s;
    min-width: 110px;
    user-select: none;
}
.ingredient-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 14px rgba(0,0,0,0.13);
}
.ingredient-btn:active { transform: scale(0.96); }
.ingredient-btn.selected {
    border-color: #FF4500 !important;
    box-shadow: 0 0 0 4px rgba(255,69,0,0.25), 0 4px 14px rgba(0,0,0,0.1);
    transform: scale(1.07);
}

/* -- color-coded buttons -- */
.ingredient-base-vanilla       { background: linear-gradient(135deg,#F5DEB3,#DEB887); border-color:#D2B48C; }
.ingredient-base-chocolate     { background: linear-gradient(135deg,#6B3A2A,#4A2518); border-color:#3B1F10; color:#fff; }
.ingredient-base-strawberry    { background: linear-gradient(135deg,#FFB3BA,#FF8A95); border-color:#E87A85; }
.ingredient-cream-whipped      { background: #FFFFF0; border-color:#DDD8C4; }
.ingredient-cream-chocolate    { background: linear-gradient(135deg,#8B5E3C,#6B3A2A); border-color:#5A2E1A; color:#fff; }
.ingredient-cream-strawberry   { background: linear-gradient(135deg,#FF87A0,#FF5C7A); border-color:#E04A68; }
.ingredient-topping-cherry     { background: linear-gradient(135deg,#FF4444,#CC0000); border-color:#AA0000; color:#fff; }
.ingredient-topping-cookie     { background: linear-gradient(135deg,#E8C97A,#C4A055); border-color:#B08A40; }
.ingredient-topping-nuts       { background: linear-gradient(135deg,#D4A574,#B8864A); border-color:#9A7040; }
.ingredient-decoration-sprinkles      { background: linear-gradient(135deg,#FF6B6B,#4ECDC4); border-color:#48B0A8; color:#fff; }
.ingredient-decoration-chocolate_chips { background: linear-gradient(135deg,#5C3317,#3B2106); border-color:#2A1705; color:#fff; }
.ingredient-decoration-star           { background: linear-gradient(135deg,#FFD700,#FFA500); border-color:#E09500; }
.ingredient-sauce-caramel      { background: linear-gradient(135deg,#E6A817,#CC8800); border-color:#AA7000; }
.ingredient-sauce-chocolate    { background: linear-gradient(135deg,#5C3317,#3B2106); border-color:#2A1705; color:#fff; }
.ingredient-sauce-strawberry   { background: linear-gradient(135deg,#FF69B4,#FF1493); border-color:#D01080; color:#fff; }

/* ===== Cake Visuals ===== */
.cake {
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 0;
    padding-bottom: 8px;
}
.cake::before {
    content: "";
    display: block;
    width: 140px;
    height: 10px;
    background: #E0D5CA;
    border-radius: 50%;
    flex-shrink: 0;
}
.cake-layer { animation: dropIn 0.25s ease-out; }
@keyframes dropIn {
    from { transform: translateY(-20px); opacity: 0; }
    to   { transform: translateY(0);     opacity: 1; }
}

/* Base */
.cake-base { width: 110px; height: 55px; border-radius: 6px 6px 4px 4px; }
.cake-base-vanilla    { background: linear-gradient(180deg,#F5DEB3,#DEB887); }
.cake-base-chocolate  { background: linear-gradient(180deg,#6B3A2A,#4A2518); }
.cake-base-strawberry { background: linear-gradient(180deg,#FFB3BA,#FF8A95); }

/* Cream */
.cake-cream { width: 122px; height: 20px; border-radius: 8px; }
.cake-cream-whipped    { background: #FFFFF0; border: 2px solid #EAE3D2; }
.cake-cream-chocolate  { background: linear-gradient(180deg,#8B5E3C,#6B3A2A); }
.cake-cream-strawberry { background: linear-gradient(180deg,#FF87A0,#FF5C7A); }

/* Topping */
.cake-topping { width: 26px; height: 26px; position: relative; }
.cake-topping-cherry {
    background: radial-gradient(circle at 40% 40%,#FF4444,#CC0000);
    border-radius: 50%;
}
.cake-topping-cherry::after {
    content: ""; position: absolute; top: -7px; left: 50%;
    transform: translateX(-50%); width: 2px; height: 9px;
    background: #2E8B57; border-radius: 1px;
}
.cake-topping-cookie {
    background: radial-gradient(circle at 40% 35%,#E8C97A,#C4A055);
    border-radius: 50%;
    box-shadow: inset 2px 2px 0 #A0843A, inset -2px -2px 0 #A0843A;
}
.cake-topping-nuts {
    background: radial-gradient(circle at 40% 40%,#D4A574,#B8864A);
    border-radius: 35% 55% 40% 50%;
}

/* Decoration */
.cake-decoration { width: 110px; height: 14px; border-radius: 3px; }
.cake-decoration-sprinkles {
    background: repeating-linear-gradient(90deg,#FF6B6B 0 4px,#4ECDC4 4px 8px,#FFE66D 8px 12px,#A8E6CF 12px 16px);
}
.cake-decoration-chocolate_chips {
    background: repeating-linear-gradient(90deg,transparent 0 5px,#3B2106 5px 9px);
    border-radius: 4px;
}
.cake-decoration-star {
    width: 26px; height: 26px; background: #FFD700;
    clip-path: polygon(50% 0%,61% 35%,98% 35%,68% 57%,79% 91%,50% 70%,21% 91%,32% 57%,2% 35%,39% 35%);
}

/* Sauce */
.cake-sauce { width: 115px; height: 10px; border-radius: 0 0 6px 6px; }
.cake-sauce-caramel    { background: linear-gradient(180deg,#E6A817,#CC8800); }
.cake-sauce-chocolate  { background: linear-gradient(180deg,#3B2106,#2A1705); }
.cake-sauce-strawberry { background: linear-gradient(180deg,#FF69B4,#FF1493); }

/* ===== Overlay ===== */
#overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.55);
    display: flex; align-items: center; justify-content: center;
    z-index: 200;
    transition: opacity 0.3s;
}
#overlay.hidden { opacity: 0; pointer-events: none; }
#overlay-content {
    background: #fff; border-radius: 18px;
    padding: 36px 48px; text-align: center;
    box-shadow: 0 8px 32px rgba(0,0,0,0.25);
}
#overlay-title { font-size: 1.8rem; margin-bottom: 10px; }
#overlay-message { font-size: 1.1rem; margin-bottom: 22px; color: #666; }
#new-game-btn {
    padding: 12px 32px; border: none; border-radius: 10px;
    background: #FF8C69; color: #fff; font-size: 1.1rem; font-weight: 700;
    cursor: pointer; transition: background 0.2s;
}
#new-game-btn:hover { background: #FF7043; }

/* ===== Feedback toast ===== */
.feedback {
    position: fixed; top: 50%; left: 50%;
    transform: translate(-50%,-50%);
    padding: 18px 40px; border-radius: 14px;
    font-size: 1.5rem; font-weight: 700;
    z-index: 300; transition: opacity 0.4s;
    pointer-events: none;
}
.feedback.hidden { opacity: 0; }
.feedback-correct   { background: #4CAF50; color: #fff; }
.feedback-incorrect { background: #F44336; color: #fff; }

/* ===== Responsive ===== */
@media (max-width: 700px) {
    #game-area { flex-direction: column; align-items: stretch; }
    #order-panel { width: 100%; }
    #order-cake { min-height: 100px; }
}
